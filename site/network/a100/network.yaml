mpi:
  cray-mpich:
    specs: ["libfabric@1.22"]
  openmpi:
    specs: ["libfabric@2.2.0 fabrics=lnx"]
packages:
  # adding a variant to the variants field of a package
  #   e.g. packages:openmpi:variants
  # is not strong enough: if that variant does not exist it simply will be ignored with no error message
  openmpi:
    buildable: true
    require:
      - 'schedulers=slurm'
      - 'fabrics=cma,ofi,xpmem'
      - '+internal-pmix'
      - '+cray-xpmem'
    prefer:
      - '+cuda'
    variants: []
  cray-mpich:
    buildable: true
    prefer:
      - '+cuda'
      - '@8.1.32'
  libfabric:
    buildable: true
    externals:
    - spec: libfabric@1.22.0 fabrics=cxi,rxm,tcp,rxd,udp,shm +cuda cuda_arch=80
      prefix: /opt/cray/libfabric/1.22.0/
    version: ["2.2.0"]
    require: fabrics=cxi,rxm,tcp
  libcxi:
    version: ["git.release/shs-13.0.0=13.0.0"]
  cxi-driver:
    version: ["git.release/shs-13.0.0=13.0.0"]
  cassini-headers:
    version: ["git.release/shs-13.0.0=13.0.0"]

